# nrf52_bledfu_win
Console Windows app to upload an application via BLE on nRF52 MCU that has the DFU Service installed.<br/>
It works only on Windows versions >= 10 and a PC with a Bluetooth 4.0 interface<br/>
Usage: OTADfu_Console.exe [help] or [scan] or [update -f <bin_file> -d <dat_file> -a <device_address>] or [update -z <zip_file> -a <device_address>]<br/>
<br/>
OTA DFU update application for nrf5x MCUs. Visit https://github.com/astronomer80/nrf52_bledfu_win for more information<br/>
Here a list of commands available:<br/>
help: Show this help<br/>
scan: Scan BLE devices already paired with Windows Settings<br/>
update -f < bin_file > -d < dat_file > -a <device_address>. bin_file is the file generated from the Arduino IDE. dat_file is the init packet generated by nrfutil application. device_address: is the address of the device returned using 'scan' command.<br/>
update -z < zip_file > -a <device_address>. zip_file is the archive generated by nrfutil application. device_address: is the address of the device returned using 'scan' command.<br/>
update -h < hex_file/bin_file > -a <device_address>. hex_file or the bin_file is generated by the Arduino IDE. nrfutil application generates the zip archive. device_address: is the address of the device returned using 'scan' command.<br/>
<br/>
<i>Optional parameter</i>
-v: Verbose mode. Adding this parameter as last shows more information during the update procedure.
<br/>
Example:<br/>
OTADfu_Console.exe help<br/>
OTADfu_Console.exe scan<br/>
OTADfu_Console.exe update -z application.zip -a xxxxxxx<br/>
OTADfu_Console.exe update -f application.bin -d application.dat -a xxxxxxx<br/>
OTADfu_Console.exe update -h application.bin -a xxxxxxx -v<br/>
where xxxxxxx is the device address returned by scan command
<br/>
DFU Procedure performed by this application:<br/>
<br/>
1)Send 'START DFU' opcode + Application Command (0x0104)<br/>
2)Send the image size<br/>
3)Send 'INIT DFU' Command (0x0200): Called in the controlPoint_CalueChanged event invoked when the BLE device replies after sending the image size.<br/>
4)Transmit the Init image (The file DAT content)<br/>
5)Send 'INIT DFU' + Complete Command (0x0201)<br/>
6)Send packet receipt notification interval (currently 10)<br/>
7)Send 'RECEIVE FIRMWARE IMAGE' command to set DFU in firmware receive state.  (0x0300)<br/>
8)Send bin array contents as a series of packets (burst mode).  Each segment is pkt_payload_size bytes long. For every packet send, wait for notification.<br/>
9)Send Validate Command (0x0400)<br/>
10)Send Activate and Reset Command (0x0500) <br/>

<br/>
# TODO # <br/>
- Manage ecprypted packates <br/>
- Update bootloader and softdevice, too <br/>
